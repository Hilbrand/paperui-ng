class Pattern{static initClass(){this.prototype.regex=null,this.prototype.rawRegex=null,this.prototype.cleanedRegex=null,this.prototype.mapping=null}constructor(t,s){null==s&&(s="");let n="";const i=t.length;let o=null,h=0,E=0;for(;E<i;){const s=t.charAt(E);if("\\"===s)n+=t.slice(E,+(E+1)+1||void 0),E++;else if("("===s)if(E<i-2){const r=t.slice(E,+(E+2)+1||void 0);if("(?:"===r)E+=2,n+=r;else if("(?<"===r){h++,E+=2;let s="";for(;E+1<i;){const i=t.charAt(E+1);if(">"===i){n+="(",E++,s.length>0&&(null==o&&(o={}),o[s]=h);break}s+=i,E++}}else n+=s,h++}else n+=s;else n+=s;E++}this.rawRegex=t,this.cleanedRegex=n,this.regex=new RegExp(this.cleanedRegex,`g${s.replace("g","")}`),this.mapping=o}exec(t){this.regex.lastIndex=0;const s=this.regex.exec(t);if(null==s)return null;if(null!=this.mapping)for(let t in this.mapping){const n=this.mapping[t];s[t]=s[n]}return s}test(t){return this.regex.lastIndex=0,this.regex.test(t)}replace(t,s){return this.regex.lastIndex=0,t.replace(this.regex,s)}replaceAll(t,s,n){null==n&&(n=0),this.regex.lastIndex=0;let i=0;for(;this.regex.test(t)&&(0===n||i<n);)this.regex.lastIndex=0,t=t.replace(this.regex,s),i++;return[t,i]}}Pattern.initClass();class Utils{static initClass(){this.REGEX_LEFT_TRIM_BY_CHAR={},this.REGEX_RIGHT_TRIM_BY_CHAR={},this.REGEX_SPACES=/\s+/g,this.REGEX_DIGITS=/^\d+$/,this.REGEX_OCTAL=/[^0-7]/gi,this.REGEX_HEXADECIMAL=/[^a-f0-9]/gi,this.PATTERN_DATE=new Pattern("^(?<year>[0-9][0-9][0-9][0-9])-(?<month>[0-9][0-9]?)-(?<day>[0-9][0-9]?)(?:(?:[Tt]|[ \t]+)(?<hour>[0-9][0-9]?):(?<minute>[0-9][0-9]):(?<second>[0-9][0-9])(?:.(?<fraction>[0-9]*))?(?:[ \t]*(?<tz>Z|(?<tz_sign>[-+])(?<tz_hour>[0-9][0-9]?)(?::(?<tz_minute>[0-9][0-9]))?))?)?$","i"),this.LOCAL_TIMEZONE_OFFSET=60*(new Date).getTimezoneOffset()*1e3}static trim(t,s){null==s&&(s="\\s");let n=this.REGEX_LEFT_TRIM_BY_CHAR[s];null==n&&(this.REGEX_LEFT_TRIM_BY_CHAR[s]=n=new RegExp(`^${s}${s}*`)),n.lastIndex=0;let i=this.REGEX_RIGHT_TRIM_BY_CHAR[s];return null==i&&(this.REGEX_RIGHT_TRIM_BY_CHAR[s]=i=new RegExp(s+""+s+"*$")),i.lastIndex=0,t.replace(n,"").replace(i,"")}static ltrim(t,s){null==s&&(s="\\s");let n=this.REGEX_LEFT_TRIM_BY_CHAR[s];return null==n&&(this.REGEX_LEFT_TRIM_BY_CHAR[s]=n=new RegExp(`^${s}${s}*`)),n.lastIndex=0,t.replace(n,"")}static rtrim(t,s){null==s&&(s="\\s");let n=this.REGEX_RIGHT_TRIM_BY_CHAR[s];return null==n&&(this.REGEX_RIGHT_TRIM_BY_CHAR[s]=n=new RegExp(s+""+s+"*$")),n.lastIndex=0,t.replace(n,"")}static isEmpty(t){return!t||""===t||"0"===t||t instanceof Array&&0===t.length||this.isEmptyObject(t)}static isEmptyObject(t){return t instanceof Object&&0===(()=>{const s=[];for(let n of Object.keys(t||{}))s.push(n);return s})().length}static subStrCount(t,s,n,i){let o=0;t=`${t}`,s=`${s}`,null!=n&&(t=t.slice(n)),null!=i&&(t=t.slice(0,i));const h=t.length,E=s.length;for(let n=0,i=n,r=h,l=0<=r;l?n<r:n>r;l?n++:n--,i=n)s===t.slice(i,E)&&(o++,i+=E-1);return o}static isDigits(t){return this.REGEX_DIGITS.lastIndex=0,this.REGEX_DIGITS.test(t)}static octDec(t){return this.REGEX_OCTAL.lastIndex=0,parseInt((t+"").replace(this.REGEX_OCTAL,""),8)}static hexDec(t){return this.REGEX_HEXADECIMAL.lastIndex=0,"0x"===((t=this.trim(t))+"").slice(0,2)&&(t=(t+"").slice(2)),parseInt((t+"").replace(this.REGEX_HEXADECIMAL,""),16)}static utf8chr(t){const s=String.fromCharCode;return 128>(t%=2097152)?s(t):2048>t?s(192|t>>6)+s(128|63&t):65536>t?s(224|t>>12)+s(128|t>>6&63)+s(128|63&t):s(240|t>>18)+s(128|t>>12&63)+s(128|t>>6&63)+s(128|63&t)}static parseBoolean(t,s){if(null==s&&(s=!0),"string"==typeof t){const n=t.toLowerCase();return!(!s&&"no"===n)&&("0"!==n&&("false"!==n&&""!==n))}return!!t}static isNumeric(t){return this.REGEX_SPACES.lastIndex=0,"number"==typeof t||"string"==typeof t&&!isNaN(t)&&""!==t.replace(this.REGEX_SPACES,"")}static stringToDate(t){let s,n,i;if(!(null!=t?t.length:void 0))return null;const o=this.PATTERN_DATE.exec(t);if(!o)return null;const h=parseInt(o.year,10),E=parseInt(o.month,10)-1,r=parseInt(o.day,10);if(null==o.hour)return s=new Date(Date.UTC(h,E,r));const l=parseInt(o.hour,10),T=parseInt(o.minute,10),A=parseInt(o.second,10);if(null!=o.fraction){for(n=o.fraction.slice(0,3);n.length<3;)n+="0";n=parseInt(n,10)}else n=0;if(null!=o.tz){let t;i=6e4*(60*parseInt(o.tz_hour,10)+(t=null!=o.tz_minute?parseInt(o.tz_minute,10):0)),"-"===o.tz_sign&&(i*=-1)}return s=new Date(Date.UTC(h,E,r,l,T,A,n)),i&&s.setTime(s.getTime()-i),s}static strRepeat(t,s){let n="",i=0;for(;i<s;)n+=t,i++;return n}static getStringFromFile(t,s=null){let n=null;if("undefined"!=typeof window&&null!==window)if(window.XMLHttpRequest)n=new XMLHttpRequest;else if(window.ActiveXObject)for(let t of["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"])try{n=new ActiveXObject(t)}catch(t){}if(null!=n)return null!=s?(n.onreadystatechange=function(){if(4===n.readyState)return 200===n.status||0===n.status?s(n.responseText):s(null)},n.open("GET",t,!0),n.send(null)):(n.open("GET",t,!1),n.send(null),200===n.status||0===n.status?n.responseText:null);{const n=require("fs");if(null!=s)return n.readFile(t,function(t,n){return s(t?null:String(n))});{const s=n.readFileSync(t);return null!=s?String(s):null}}}}Utils.initClass();class Unescaper{static initClass(){this.PATTERN_ESCAPED_CHARACTER=new Pattern('\\\\([0abt\tnvfre "\\/\\\\N_LP]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|U[0-9a-fA-F]{8})')}static unescapeSingleQuotedString(t){return t.replace(/\'\'/g,"'")}static unescapeDoubleQuotedString(t){return null==this._unescapeCallback&&(this._unescapeCallback=(t=>this.unescapeCharacter(t))),this.PATTERN_ESCAPED_CHARACTER.replace(t,this._unescapeCallback)}static unescapeCharacter(t){const s=String.fromCharCode;switch(t.charAt(1)){case"0":return s(0);case"a":return s(7);case"b":return s(8);case"t":case"\t":return"\t";case"n":return"\n";case"v":return s(11);case"f":return s(12);case"r":return s(13);case"e":return s(27);case" ":return" ";case'"':return'"';case"/":return"/";case"\\":return"\\";case"N":return s(133);case"_":return s(160);case"L":return s(8232);case"P":return s(8233);case"x":return Utils.utf8chr(Utils.hexDec(t.substr(2,2)));case"u":return Utils.utf8chr(Utils.hexDec(t.substr(2,4)));case"U":return Utils.utf8chr(Utils.hexDec(t.substr(2,8)));default:return""}}}Unescaper.initClass();class Escaper{static initClass(){let t;this.LIST_ESCAPEES=["\\","\\\\",'\\"','"',"\0","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","","","","","","","","","","","","","",(t=String.fromCharCode)(133),t(160),t(8232),t(8233)],this.LIST_ESCAPED=["\\\\",'\\"','\\"','\\"',"\\0","\\x01","\\x02","\\x03","\\x04","\\x05","\\x06","\\a","\\b","\\t","\\n","\\v","\\f","\\r","\\x0e","\\x0f","\\x10","\\x11","\\x12","\\x13","\\x14","\\x15","\\x16","\\x17","\\x18","\\x19","\\x1a","\\e","\\x1c","\\x1d","\\x1e","\\x1f","\\N","\\_","\\L","\\P"],this.MAPPING_ESCAPEES_TO_ESCAPED=(()=>{const t={};for(let s=0,n=this.LIST_ESCAPEES.length,i=0<=n;i?s<n:s>n;i?s++:s--)t[this.LIST_ESCAPEES[s]]=this.LIST_ESCAPED[s];return t})(),this.PATTERN_CHARACTERS_TO_ESCAPE=new Pattern("[\\x00-\\x1f]|Ã‚Â…|Ã‚Â |Ã¢Â€Â¨|Ã¢Â€Â©"),this.PATTERN_MAPPING_ESCAPEES=new Pattern(this.LIST_ESCAPEES.join("|").split("\\").join("\\\\")),this.PATTERN_SINGLE_QUOTING=new Pattern("[\\s'\":{}[\\],&*#?]|^[-?|<>=!%@`]")}static requiresDoubleQuoting(t){return this.PATTERN_CHARACTERS_TO_ESCAPE.test(t)}static escapeWithDoubleQuotes(t){return`"${this.PATTERN_MAPPING_ESCAPEES.replace(t,t=>this.MAPPING_ESCAPEES_TO_ESCAPED[t])}"`}static requiresSingleQuoting(t){return this.PATTERN_SINGLE_QUOTING.test(t)}static escapeWithSingleQuotes(t){return`'${t.replace(/'/g,"''")}'`}}Escaper.initClass();class ParseException extends Error{constructor(t,s,n){this.message=t,this.parsedLine=s,this.snippet=n}toString(){return null!=this.parsedLine&&null!=this.snippet?`<ParseException> ${this.message} (line ${this.parsedLine}: '${this.snippet}')`:`<ParseException> ${this.message}`}}class ParseMore extends Error{constructor(t,s,n){this.message=t,this.parsedLine=s,this.snippet=n}toString(){return null!=this.parsedLine&&null!=this.snippet?`<ParseMore> ${this.message} (line ${this.parsedLine}: '${this.snippet}')`:`<ParseMore> ${this.message}`}}class Inline{static initClass(){this.REGEX_QUOTED_STRING="(?:\"(?:[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\"|'(?:[^']*(?:''[^']*)*)')",this.PATTERN_TRAILING_COMMENTS=new Pattern("^\\s*#.*$"),this.PATTERN_QUOTED_SCALAR=new Pattern(`^${this.REGEX_QUOTED_STRING}`),this.PATTERN_THOUSAND_NUMERIC_SCALAR=new Pattern("^(-|\\+)?[0-9,]+(\\.[0-9]+)?$"),this.PATTERN_SCALAR_BY_DELIMITERS={},this.settings={}}static configure(t=null,s=null){this.settings.exceptionOnInvalidType=t,this.settings.objectDecoder=s}static parse(t,s,n=null){let i;if(null==s&&(s=!1),this.settings.exceptionOnInvalidType=s,this.settings.objectDecoder=n,null==t)return"";if(0===(t=Utils.trim(t)).length)return"";const o={exceptionOnInvalidType:s,objectDecoder:n,i:0};switch(t.charAt(0)){case"[":i=this.parseSequence(t,o),++o.i;break;case"{":i=this.parseMapping(t,o),++o.i;break;default:i=this.parseScalar(t,null,['"',"'"],o)}if(""!==this.PATTERN_TRAILING_COMMENTS.replace(t.slice(o.i),""))throw new ParseException(`Unexpected characters near "${t.slice(o.i)}".`);return i}static dump(t,s,n=null){let i;if(null==s&&(s=!1),null==t)return"null";const o=typeof t;if("object"===o){if(t instanceof Date)return t.toISOString();if(null!=n){const s=n(t);if("string"==typeof s||null!=s)return s}return this.dumpObject(t)}return"boolean"===o?t?"true":"false":Utils.isDigits(t)?"string"===o?`'${t}'`:String(parseInt(t)):Utils.isNumeric(t)?"string"===o?`'${t}'`:String(parseFloat(t)):"number"===o?t===1/0?".Inf":t===-1/0?"-.Inf":isNaN(t)?".NaN":t:Escaper.requiresDoubleQuoting(t)?Escaper.escapeWithDoubleQuotes(t):Escaper.requiresSingleQuoting(t)?Escaper.escapeWithSingleQuotes(t):""===t?'""':Utils.PATTERN_DATE.test(t)?`'${t}'`:(i=t.toLowerCase(),["null","~","true","false"].includes(i)?`'${t}'`:t)}static dumpObject(t,s,n=null){let i,o;if(t instanceof Array){for(o of(i=[],Array.from(t)))i.push(this.dump(o));return`[${i.join(", ")}]`}i=[];for(let s in t)o=t[s],i.push(this.dump(s)+": "+this.dump(o));return`{${i.join(", ")}}`}static parseScalar(t,s=null,n,i=null,o){let h,E;null==n&&(n=['"',"'"]),null==o&&(o=!0),null==i&&(i={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0});let{i:r}=i;if(h=t.charAt(r),Array.from(n).includes(h)){if(E=this.parseQuotedScalar(t,i),({i:r}=i),null!=s){let n;if(n=Utils.ltrim(t.slice(r)," ").charAt(0),!Array.from(s).includes(n))throw new ParseException(`Unexpected characters (${t.slice(r)}).`)}}else{if(s){let n;const i=s.join("|");let o=this.PATTERN_SCALAR_BY_DELIMITERS[i];if(null==o&&(o=new Pattern(`^(.+?)(${i})`),this.PATTERN_SCALAR_BY_DELIMITERS[i]=o),!(n=o.exec(t.slice(r))))throw new ParseException(`Malformed inline YAML string (${t}).`);r+=(E=n[1]).length}else{r+=(E=t.slice(r)).length;const s=E.indexOf(" #");-1!==s&&(E=Utils.rtrim(E.slice(0,s)))}o&&(E=this.evaluateScalar(E,i))}return i.i=r,E}static parseQuotedScalar(t,s){let n,{i:i}=s;if(!(n=this.PATTERN_QUOTED_SCALAR.exec(t.slice(i))))throw new ParseMore(`Malformed inline YAML string (${t.slice(i)}).`);let o=n[0].substr(1,n[0].length-2);return o='"'===t.charAt(i)?Unescaper.unescapeDoubleQuotedString(o):Unescaper.unescapeSingleQuotedString(o),i+=n[0].length,s.i=i,o}static parseSequence(t,s){const n=[],i=t.length;let{i:o}=s;for(o+=1;o<i;){var h;switch(s.i=o,t.charAt(o)){case"[":n.push(this.parseSequence(t,s)),({i:o}=s);break;case"{":n.push(this.parseMapping(t,s)),({i:o}=s);break;case"]":return n;case",":case" ":case"\n":break;default:var E=(h=t.charAt(o),['"',"'"].includes(h)),r=this.parseScalar(t,[",","]"],['"',"'"],s);if(({i:o}=s),!E&&"string"==typeof r&&(-1!==r.indexOf(": ")||-1!==r.indexOf(":\n")))try{r=this.parseMapping(`{${r}}`)}catch(t){}n.push(r),--o}++o}throw new ParseMore(`Malformed inline YAML string ${t}`)}static parseMapping(t,s){const n={},i=t.length;let{i:o}=s;o+=1;let h=!1;for(;o<i;){switch(s.i=o,t.charAt(o)){case" ":case",":case"\n":++o,s.i=o,h=!0;break;case"}":return n}if(h){h=!1;continue}const r=this.parseScalar(t,[":"," ","\n"],['"',"'"],s,!1);({i:o}=s);let l=!1;for(;o<i;){switch(s.i=o,t.charAt(o)){case"[":var E=this.parseSequence(t,s);({i:o}=s),void 0===n[r]&&(n[r]=E),l=!0;break;case"{":E=this.parseMapping(t,s),({i:o}=s),void 0===n[r]&&(n[r]=E),l=!0;break;case":":case" ":case"\n":break;default:E=this.parseScalar(t,[",","}"],['"',"'"],s),({i:o}=s),void 0===n[r]&&(n[r]=E),l=!0,--o}if(++o,l)break}}throw new ParseMore(`Malformed inline YAML string ${t}`)}static evaluateScalar(t,s){let n,i,o,h;const E=(t=Utils.trim(t)).toLowerCase();switch(E){case"null":case"":case"~":return null;case"true":return!0;case"false":return!1;case".inf":return 1/0;case".nan":return NaN;case"-.inf":return 1/0;default:switch(E.charAt(0)){case"!":var r=t.indexOf(" ");switch(o=-1===r?E:E.slice(0,r)){case"!":return-1!==r?parseInt(this.parseScalar(t.slice(2))):null;case"!str":return Utils.ltrim(t.slice(4));case"!!str":return Utils.ltrim(t.slice(5));case"!!int":return parseInt(this.parseScalar(t.slice(5)));case"!!bool":return Utils.parseBoolean(this.parseScalar(t.slice(6)),!1);case"!!float":return parseFloat(this.parseScalar(t.slice(7)));case"!!timestamp":return Utils.stringToDate(Utils.ltrim(t.slice(11)));default:null==s&&(s={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0});var{objectDecoder:l,exceptionOnInvalidType:T}=s;if(l){const s=Utils.rtrim(t);if(-1===(r=s.indexOf(" ")))return l(s,null);{let t=Utils.ltrim(s.slice(r+1));return t.length>0||(t=null),l(s.slice(0,r),t)}}if(T)throw new ParseException("Custom object support when parsing a YAML file has been disabled.");return null}case"0":return"0x"===t.slice(0,2)?Utils.hexDec(t):Utils.isDigits(t)?Utils.octDec(t):Utils.isNumeric(t)?parseFloat(t):t;case"+":return Utils.isDigits(t)?(h=t,n=parseInt(h),h===String(n)?n:h):Utils.isNumeric(t)?parseFloat(t):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(t)?parseFloat(t.replace(",","")):t;case"-":return Utils.isDigits(t.slice(1))?"0"===t.charAt(1)?-Utils.octDec(t.slice(1)):(h=t.slice(1),n=parseInt(h),h===String(n)?-n:-h):Utils.isNumeric(t)?parseFloat(t):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(t)?parseFloat(t.replace(",","")):t;default:return(i=Utils.stringToDate(t))?i:Utils.isNumeric(t)?parseFloat(t):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(t)?parseFloat(t.replace(",","")):t}}}}Inline.initClass();class Parser{static initClass(){this.prototype.PATTERN_FOLDED_SCALAR_ALL=new Pattern("^(?:(?<type>![^\\|>]*)\\s+)?(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$"),this.prototype.PATTERN_FOLDED_SCALAR_END=new Pattern("(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$"),this.prototype.PATTERN_SEQUENCE_ITEM=new Pattern("^\\-((?<leadspaces>\\s+)(?<value>.+?))?\\s*$"),this.prototype.PATTERN_ANCHOR_VALUE=new Pattern("^&(?<ref>[^ ]+) *(?<value>.*)"),this.prototype.PATTERN_COMPACT_NOTATION=new Pattern(`^(?<key>${Inline.REGEX_QUOTED_STRING}|[^ '"\\{\\[].*?) *\\:(\\s+(?<value>.+?))?\\s*$`),this.prototype.PATTERN_MAPPING_ITEM=new Pattern(`^(?<key>${Inline.REGEX_QUOTED_STRING}|[^ '"\\[\\{].*?) *\\:(\\s+(?<value>.+?))?\\s*$`),this.prototype.PATTERN_DECIMAL=new Pattern("\\d+"),this.prototype.PATTERN_INDENT_SPACES=new Pattern("^ +"),this.prototype.PATTERN_TRAILING_LINES=new Pattern("(\n*)$"),this.prototype.PATTERN_YAML_HEADER=new Pattern("^\\%YAML[: ][\\d\\.]+.*\n","m"),this.prototype.PATTERN_LEADING_COMMENTS=new Pattern("^(\\#.*?\n)+","m"),this.prototype.PATTERN_DOCUMENT_MARKER_START=new Pattern("^\\-\\-\\-.*?\n","m"),this.prototype.PATTERN_DOCUMENT_MARKER_END=new Pattern("^\\.\\.\\.\\s*$","m"),this.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION={},this.prototype.CONTEXT_NONE=0,this.prototype.CONTEXT_SEQUENCE=1,this.prototype.CONTEXT_MAPPING=2}constructor(t){null==t&&(t=0),this.offset=t,this.lines=[],this.currentLineNb=-1,this.currentLine="",this.refs={}}parse(t,s,n=null){null==s&&(s=!1),this.currentLineNb=-1,this.currentLine="",this.lines=this.cleanup(t).split("\n");let i=null,o=this.CONTEXT_NONE,h=!1;for(;this.moveToNextLine();){var E,r,l,T,A,_,L;if(this.isCurrentLineEmpty())continue;if("\t"===this.currentLine[0])throw new ParseException("A YAML file cannot contain tabs as indentation.",this.getRealCurrentLineNb()+1,this.currentLine);let U=A=!1;if(L=this.PATTERN_SEQUENCE_ITEM.exec(this.currentLine)){if(this.CONTEXT_MAPPING===o)throw new ParseException("You cannot define a sequence item when in a mapping");if(o=this.CONTEXT_SEQUENCE,null==i&&(i=[]),null!=L.value&&(T=this.PATTERN_ANCHOR_VALUE.exec(L.value))&&(U=T.ref,L.value=T.value),null==L.value||""===Utils.trim(L.value," ")||0===Utils.ltrim(L.value," ").indexOf("#"))this.currentLineNb<this.lines.length-1&&!this.isNextLineUnIndentedCollection()?(E=this.getRealCurrentLineNb()+1,(_=new Parser(E)).refs=this.refs,i.push(_.parse(this.getNextEmbedBlock(null,!0),s,n))):i.push(null);else if((null!=L.leadspaces?L.leadspaces.length:void 0)&&(T=this.PATTERN_COMPACT_NOTATION.exec(L.value))){E=this.getRealCurrentLineNb(),(_=new Parser(E)).refs=this.refs;let t=L.value;const o=this.getCurrentLineIndentation();this.isNextLineIndented(!1)&&(t+=`\n${this.getNextEmbedBlock(o+L.leadspaces.length+1,!0)}`),i.push(_.parse(t,s,n))}else i.push(this.parseValue(L.value,s,n))}else{if(!(L=this.PATTERN_MAPPING_ITEM.exec(this.currentLine))||-1!==L.key.indexOf(" #")){var c;const o=this.lines.length;if(1===o||2===o&&Utils.isEmpty(this.lines[1])){try{t=Inline.parse(this.lines[0],s,n)}catch(t){throw(r=t).parsedLine=this.getRealCurrentLineNb()+1,r.snippet=this.currentLine,r}if("object"==typeof t){var P;if(t instanceof Array)P=t[0];else for(l in t){P=t[l];break}if("string"==typeof P&&0===P.indexOf("*")){i=[];for(let s of Array.from(t))i.push(this.refs[s.slice(1)]);t=i}}return t}if(c=Utils.ltrim(t).charAt(0),["[","{"].includes(c))try{return Inline.parse(t,s,n)}catch(t){throw(r=t).parsedLine=this.getRealCurrentLineNb()+1,r.snippet=this.currentLine,r}throw new ParseException("Unable to parse.",this.getRealCurrentLineNb()+1,this.currentLine)}var S,f;if(this.CONTEXT_SEQUENCE===o)throw new ParseException("You cannot define a mapping item when in a sequence");o=this.CONTEXT_MAPPING,null==i&&(i={}),Inline.configure(s,n);try{l=Inline.parseScalar(L.key)}catch(t){throw(r=t).parsedLine=this.getRealCurrentLineNb()+1,r.snippet=this.currentLine,r}if("<<"===l)if(A=!0,h=!0,0===(null!=L.value?L.value.indexOf("*"):void 0)){const s=L.value.slice(1);if(null==this.refs[s])throw new ParseException(`Reference "${s}" does not exist.`,this.getRealCurrentLineNb()+1,this.currentLine);const n=this.refs[s];if("object"!=typeof n)throw new ParseException("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine);if(n instanceof Array)for(f=0;f<n.length;f++){var N;t=n[f],null==i[N=String(f)]&&(i[N]=t)}else for(l in n)t=n[l],null==i[l]&&(i[l]=t)}else{null!=L.value&&""!==L.value?({value:t}=L):t=this.getNextEmbedBlock(),E=this.getRealCurrentLineNb()+1,(_=new Parser(E)).refs=this.refs;const n=_.parse(t,s);if("object"!=typeof n)throw new ParseException("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine);if(n instanceof Array)for(let s of Array.from(n)){if("object"!=typeof s)throw new ParseException("Merge items must be objects.",this.getRealCurrentLineNb()+1,s);if(s instanceof Array)for(f=0;f<s.length;f++){t=s[f];const n=String(f);i.hasOwnProperty(n)||(i[n]=t)}else for(l in s)t=s[l],i.hasOwnProperty(l)||(i[l]=t)}else for(l in n)t=n[l],i.hasOwnProperty(l)||(i[l]=t)}else null!=L.value&&(T=this.PATTERN_ANCHOR_VALUE.exec(L.value))&&(U=T.ref,L.value=T.value);A||(null==L.value||""===Utils.trim(L.value," ")||0===Utils.ltrim(L.value," ").indexOf("#")?this.isNextLineIndented()||this.isNextLineUnIndentedCollection()?(E=this.getRealCurrentLineNb()+1,(_=new Parser(E)).refs=this.refs,S=_.parse(this.getNextEmbedBlock(),s,n),(h||void 0===i[l])&&(i[l]=S)):(h||void 0===i[l])&&(i[l]=null):(S=this.parseValue(L.value,s,n),(h||void 0===i[l])&&(i[l]=S)))}if(U)if(i instanceof Array)this.refs[U]=i[i.length-1];else{let t=null;for(l in i)t=l;this.refs[U]=i[t]}}return Utils.isEmpty(i)?null:i}getRealCurrentLineNb(){return this.currentLineNb+this.offset}getCurrentLineIndentation(){return this.currentLine.length-Utils.ltrim(this.currentLine," ").length}getNextEmbedBlock(t=null,s){let n,i;if(null==s&&(s=!1),this.moveToNextLine(),null==t){i=this.getCurrentLineIndentation();const t=this.isStringUnIndentedCollectionItem(this.currentLine);if(!this.isCurrentLineEmpty()&&0===i&&!t)throw new ParseException("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}else i=t;const o=[this.currentLine.slice(i)];s||(n=this.isStringUnIndentedCollectionItem(this.currentLine));const h=this.PATTERN_FOLDED_SCALAR_END;let E=!h.test(this.currentLine);for(;this.moveToNextLine();){const t=this.getCurrentLineIndentation();if(t===i&&(E=!h.test(this.currentLine)),!E||!this.isCurrentLineComment())if(this.isCurrentLineBlank())o.push(this.currentLine.slice(i));else{if(n&&!this.isStringUnIndentedCollectionItem(this.currentLine)&&t===i){this.moveToPreviousLine();break}if(t>=i)o.push(this.currentLine.slice(i));else if("#"!==Utils.ltrim(this.currentLine).charAt(0)){if(0===t){this.moveToPreviousLine();break}throw new ParseException("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}}}return o.join("\n")}moveToNextLine(){return!(this.currentLineNb>=this.lines.length-1)&&(this.currentLine=this.lines[++this.currentLineNb],!0)}moveToPreviousLine(){this.currentLine=this.lines[--this.currentLineNb]}parseValue(t,s,n){let i,o;if(0===t.indexOf("*")){const s=t.indexOf("#");if(t=-1!==s?t.substr(1,s-2):t.slice(1),void 0===this.refs[t])throw new ParseException(`Reference "${t}" does not exist.`,this.currentLine);return this.refs[t]}if(i=this.PATTERN_FOLDED_SCALAR_ALL.exec(t)){const t=null!=i.modifiers?i.modifiers:"";let o=Math.abs(parseInt(t));isNaN(o)&&(o=0);const h=this.parseFoldedScalar(i.separator,this.PATTERN_DECIMAL.replace(t,""),o);return null!=i.type?(Inline.configure(s,n),Inline.parseScalar(i.type+" "+h)):h}if(o=t.charAt(0),!["[","{",'"',"'"].includes(o))return this.isNextLineIndented()&&(t+=`\n${this.getNextEmbedBlock()}`),Inline.parse(t,s,n);for(;;)try{return Inline.parse(t,s,n)}catch(s){if(!(s instanceof ParseMore&&this.moveToNextLine()))throw s.parsedLine=this.getRealCurrentLineNb()+1,s.snippet=this.currentLine,s;t+=`\n${Utils.trim(this.currentLine," ")}`}}parseFoldedScalar(t,s,n){let i;null==s&&(s=""),null==n&&(n=0);let o=this.moveToNextLine();if(!o)return"";let h=this.isCurrentLineBlank(),E="";for(;o&&h;)(o=this.moveToNextLine())&&(E+="\n",h=this.isCurrentLineBlank());if(0===n&&(i=this.PATTERN_INDENT_SPACES.exec(this.currentLine))&&(n=i[0].length),n>0){let t=this.PATTERN_FOLDED_SCALAR_BY_INDENTATION[n];for(null==t&&(t=new Pattern(`^ {${n}}(.*)$`),Parser.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION[n]=t);o&&(h||(i=t.exec(this.currentLine)));)E+=h?this.currentLine.slice(n):i[1],(o=this.moveToNextLine())&&(E+="\n",h=this.isCurrentLineBlank())}else o&&(E+="\n");if(o&&this.moveToPreviousLine(),">"===t){let t="";for(let s of Array.from(E.split("\n")))0===s.length||" "===s.charAt(0)?t=Utils.rtrim(t," ")+s+"\n":t+=s+" ";E=t}return"+"!==s&&(E=Utils.rtrim(E)),""===s?E=this.PATTERN_TRAILING_LINES.replace(E,"\n"):"-"===s&&(E=this.PATTERN_TRAILING_LINES.replace(E,"")),E}isNextLineIndented(t){null==t&&(t=!0);const s=this.getCurrentLineIndentation();let n=!this.moveToNextLine();if(t)for(;!n&&this.isCurrentLineEmpty();)n=!this.moveToNextLine();else for(;!n&&this.isCurrentLineBlank();)n=!this.moveToNextLine();if(n)return!1;let i=!1;return this.getCurrentLineIndentation()>s&&(i=!0),this.moveToPreviousLine(),i}isCurrentLineEmpty(){const t=Utils.trim(this.currentLine," ");return 0===t.length||"#"===t.charAt(0)}isCurrentLineBlank(){return""===Utils.trim(this.currentLine," ")}isCurrentLineComment(){return"#"===Utils.ltrim(this.currentLine," ").charAt(0)}cleanup(t){let s,n;-1!==t.indexOf("\r")&&(t=t.split("\r\n").join("\n").split("\r").join("\n"));let i=0;[t,i]=Array.from(this.PATTERN_YAML_HEADER.replaceAll(t,"")),this.offset+=i,[n,i]=Array.from(this.PATTERN_LEADING_COMMENTS.replaceAll(t,"",1)),1===i&&(this.offset+=Utils.subStrCount(t,"\n")-Utils.subStrCount(n,"\n"),t=n),[n,i]=Array.from(this.PATTERN_DOCUMENT_MARKER_START.replaceAll(t,"",1)),1===i&&(this.offset+=Utils.subStrCount(t,"\n")-Utils.subStrCount(n,"\n"),t=n,t=this.PATTERN_DOCUMENT_MARKER_END.replace(t,""));const o=t.split("\n");let h=-1;for(s of Array.from(o)){if(0===Utils.trim(s," ").length)continue;const t=s.length-Utils.ltrim(s).length;(-1===h||t<h)&&(h=t)}if(h>0){for(let t=0;t<o.length;t++)s=o[t],o[t]=s.slice(h);t=o.join("\n")}return t}isNextLineUnIndentedCollection(t=null){null==t&&(t=this.getCurrentLineIndentation());let s=this.moveToNextLine();for(;s&&this.isCurrentLineEmpty();)s=this.moveToNextLine();if(!1===s)return!1;let n=!1;return this.getCurrentLineIndentation()===t&&this.isStringUnIndentedCollectionItem(this.currentLine)&&(n=!0),this.moveToPreviousLine(),n}isStringUnIndentedCollectionItem(){return"-"===this.currentLine||"- "===this.currentLine.slice(0,2)}}Parser.initClass();class Dumper{static initClass(){this.indentation=4}dump(t,s,n,i,o=null){null==s&&(s=0),null==n&&(n=0),null==i&&(i=!1);let h="";if("function"==typeof t)return h;const E=n?Utils.strRepeat(" ",n):"";if(s<=0||"object"!=typeof t||t instanceof Date||Utils.isEmpty(t))h+=E+Inline.dump(t,i,o);else{let r,l;if(t instanceof Array)for(r of Array.from(t))l=s-1<=0||"object"!=typeof r||Utils.isEmpty(r),h+=E+"- "+this.dump(r,s-1,l?0:n+this.indentation,i,o)+(l?"\n":"");else for(let T in t)r=t[T],l=s-1<=0||"object"!=typeof r||Utils.isEmpty(r),h+=E+Inline.dump(T,i,o)+":"+(l?" ":"\n")+this.dump(r,s-1,l?0:n+this.indentation,i,o)+(l?"\n":"")}return h}}Dumper.initClass();class Yaml{static parse(t,s,n=null){return null==s&&(s=!1),(new Parser).parse(t,s,n)}static parseFile(t,s=null,n,i=null){if(null==n&&(n=!1),null!=s)return Utils.getStringFromFile(t,t=>{let o=null;null!=t&&(o=this.parse(t,n,i)),s(o)});{const s=Utils.getStringFromFile(t);return null!=s?this.parse(s,n,i):null}}static dump(t,s,n,i,o=null){null==s&&(s=2),null==n&&(n=4),null==i&&(i=!1);const h=new Dumper;return h.indentation=n,h.dump(t,s,0,i,o)}static stringify(t,s,n,i,o){return this.dump(t,s,n,i,o)}static load(t,s,n,i){return this.parseFile(t,s,n,i)}}export default Yaml;